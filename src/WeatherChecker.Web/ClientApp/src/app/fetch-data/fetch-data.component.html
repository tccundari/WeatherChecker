<h1 id="tableLabel">Weather forecast</h1>

<p>This component demonstrates fetching data from the server.</p>

<p *ngIf="!forecasts"><em>Loading...</em></p>

<mat-form-field appearance="standard">
  <mat-label>State</mat-label>
  <select matNativeControl (change)="selectedState($event)">
    <option *ngFor="let state of states" [value]="state.value">
      {{state.viewValue}}
    </option>
  </select>
</mat-form-field>

<mat-form-field appearance="standard">
  <mat-label>Search Cities...</mat-label>
  <input matInput (keyup)="applyFilter($event)" placeholder="Search city" #input>
</mat-form-field>

<div #WeatherResults>
  <table class='table table-striped' aria-labelledby="tableLabel" *ngIf="forecasts" #table>
    <thead>
      <tr>
        <th>City</th>
        <th>Min</th>
        <th>Max</th>
        <th>Precision</th>
        <th>Temp. Now</th>
        <th>Lower</th>
        <th>Time Low</th>
        <th>High</th>
        <th>Time High</th>
        <th>Rain</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let forecast of forecasts">
        <td>{{ forecast.descriptionCity }}</td>
        <td>{{ forecast.min }}</td>
        <td>{{ forecast.max }}</td>
        <td>{{ forecast.precision }}</td>
        <td>{{ forecast.obsNow }}</td>
        <td>{{ forecast.obsLow }}</td>
        <td>{{ forecast.obsLowTime }}</td>
        <td>{{ forecast.obsHigh }}</td>
        <td>{{ forecast.obsHighTime }}</td>
        <td>{{ forecast.obsRain }}</td>
      </tr>
    </tbody>
  </table>
</div>
<button mat-raised-button color="primary" (click)="ExportToExcel()">Export as Excel</button>
